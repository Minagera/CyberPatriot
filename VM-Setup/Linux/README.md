# CyberPatriot Linux VM Setup: "Corporate Server Breach" Scenario

This directory provides unique resources, primarily the `corporate-server-breach.sh` script, for creating a realistic, compromised Linux server VM environment (Ubuntu 22.04 LTS recommended) suitable for CyberPatriot incident response training.

## Understanding the Competition

CyberPatriot challenges teams to act as incident responders inheriting compromised systems. Key tasks involve identifying unauthorized access, removing persistence, hardening configurations, analyzing forensic artifacts (answering README questions), and maintaining critical services. This script creates a practice environment reflecting this challenge.

## Overview

The `corporate-server-breach.sh` script transforms a clean Ubuntu installation into a compromised server simulating a post-breach scenario (e.g., a web server, internal application server). Cadets must investigate the breach using command-line tools, identify attacker actions, remove malicious components, implement proper security controls according to a scenario README, and answer forensic questions.

## Quick Start

1.  **Prepare Base VM:**
    -   Start with a **clean minimal installation** of Ubuntu 22.04 LTS Server (Desktop version also works but Server is often more realistic).
    -   Ensure network connectivity.
    -   Fully update the OS: `sudo apt update && sudo apt upgrade -y`.
    -   Install VMware Tools / VirtualBox Guest Additions if needed.
    -   **CRITICAL:** Take a VM snapshot named "Ubuntu 22.04 Clean Base - Updated YYYY-MM-DD".
2.  **Transfer Script:** Copy the `corporate-server-breach.sh` script to the **Clean Base** VM (e.g., using `scp` or copy-paste into terminal).
3.  **Make Executable:** `chmod +x corporate-server-breach.sh`
4.  **Run Script:**
    -   Execute the script **as root**: `sudo ./corporate-server-breach.sh`
    -   The script will output progress and create a log file (e.g., `/var/log/cyberpatriot_setup.log`). Review the log for errors.
5.  **Verify (Optional):** Briefly check for key changes (e.g., presence of README on Desktop if GUI, new users in `/etc/passwd`, a new cron job) to ensure the script ran.
6.  **Shut Down:** Properly shut down the VM: `sudo shutdown now`.
7.  **Final Snapshot:** Take a VM snapshot named **"Compromised Linux Server - Initial State - YYYY-MM-DD"** (or similar). **This is the snapshot you distribute to cadets for practice.**

## Scenario Features (Generated by Script - Examples)

*(These are examples; the actual script implements a specific set. Review the script for details.)*

-   **Unauthorized User Accounts:** Includes standard users, users with UID 0, users added to the `sudo` group.
-   **Weak Configurations:** Misconfigured SSH (`sshd_config` - e.g., PermitRootLogin yes), disabled firewall (UFW), weak password policies (default or modified PAM), vulnerable services running (e.g., Telnet, insecure FTP).
-   **Persistence Mechanisms:** Malicious cron jobs (user and system `/etc/cron.*`), SUID binaries created/modified, potentially modified `.bashrc` or systemd service units.
-   **Insecure Services:** Services like Telnet, VSFTPD (with insecure settings), or a simple vulnerable web server might be enabled.
-   **Forensic Artifacts:** Log entries (simulated or resulting from script actions), hidden files/directories, command history artifacts (`.bash_history`), a competition-style README file.

## Competition README (`README-Innovatech-Incident.txt` - Generated by Script)

The script creates a competition-style README file (e.g., on Desktop if GUI, or `/root` / initial user home) that includes:
-   A scenario description (e.g., suspected compromise of a web server).
-   Tasks for the incident response team (cadets).
-   List of authorized users and required services/ports.
-   Specific forensic questions requiring investigation using command-line tools.
-   (Optional) Fictional company security policy snippets.

Reading and understanding this generated README is the critical first step for cadets.

## Usage Instructions for Cadets

1.  Start the VM from the **"Compromised Linux Server - Initial State"** snapshot.
2.  Log in using the initial credentials provided in the scenario instructions (often mentioned within the script comments or instructor notes, e.g., `sysadmin_innovatech / InnovatechPass2024#`).
3.  Locate and **carefully read** the competition-style README file (e.g., `README-Innovatech-Incident.txt` on Desktop or home directory). **THIS IS YOUR PRIMARY GUIDE.**
4.  Investigate using standard Linux commands (`ps`, `ss`, `ls`, `cat`, `grep`, `find`, `systemctl`, `journalctl`, `crontab`, `history`, `id`, `groups`, `last`, `awk`, `sudo`, etc.) and potentially provided audit scripts (`../../Linux/Scripts/`).
5.  Remediate vulnerabilities, remove persistence mechanisms, and harden the system (UFW, SSH, PAM, services, permissions) according to the **README requirements** and security best practices.
6.  **Document findings and actions taken** using the Change Log template (`../../Resources/Templates/Change_Log_Template.md`).
7.  Answer the **forensic questions** using the Forensics template (`../../Resources/Templates/Forensics_Question_Response_Template.md`), citing evidence (commands used, file paths, log entries).

## Customization

-   **Edit the `corporate-server-breach.sh` script** (make a backup first!) to change usernames, passwords, persistence methods (cron entries, SUID files), vulnerabilities introduced (service configs), or the content/location of the generated README.
-   Comment/uncomment sections within the script using `#` to enable/disable specific vulnerabilities.
-   Add new vulnerabilities or forensic clues relevant to your training goals. Ensure they align with CyberPatriot scope (typically user/service config, permissions, basic persistence).
-   Create different versions of the script for varied scenarios.

## Troubleshooting

-   **Script Fails:** Ensure the script has execute permissions (`chmod +x`). Ensure it's run as root (`sudo`). Check the script log file (`/var/log/cyberpatriot_setup.log`) for specific errors. Verify the base OS is Ubuntu 22.04 LTS and was updated. Check for typos if customized.
-   **Unexpected Behavior:** Verify the base VM was clean and updated before running the script.

---
*This scenario and script are unique and designed for CyberPatriot training only. Adapt and enhance for your team's needs.*

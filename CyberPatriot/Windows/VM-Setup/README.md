# Windows VM Setup for CyberPatriot: "Enterprise Workstation Compromise" Scenario (25-26 Season)

This directory provides the `enterprise-workstation-setup.ps1` script and documentation for creating a realistic, compromised Windows VM environment. This is crucial for practicing the **incident response and remediation** skills needed for CyberPatriot.

## Understanding the Competition (Incident Response Focus)

CyberPatriot simulates inheriting a compromised network. Success requires more than just applying fixes; it demands an incident responder's mindset:

1.  **Investigate:** Identify unauthorized changes, malware, misconfigurations.
2.  **Analyze:** Understand *how* the system was compromised, find forensic clues, answer README questions.
3.  **Remediate:** Remove attacker presence (persistence, accounts, malware).
4.  **Harden:** Secure the system against future attacks while keeping required services online (per README).

## Overview

The `enterprise-workstation-setup.ps1` PowerShell script transforms a **clean** Windows installation (Win 10/11 Pro/Enterprise recommended) into a workstation simulating a post-breach state. Cadets practice investigating the breach, removing malicious elements, securing the system, and answering forensic questions based on the evidence within the VM and the generated README.

## Scenario Features (Generated by `enterprise-workstation-setup.ps1`)

*(Ensure the script actually implements these features)*
-   **Unauthorized User Accounts:** Standard users, potentially hidden/renamed admin accounts, users in sensitive groups.
-   **Weak Configurations:** Disabled/misconfigured Firewall, weak password policies, insecure service settings (e.g., unnecessary services enabled, insecure permissions).
-   **Persistence Mechanisms:** Malicious Scheduled Tasks, Registry Run key entries, potentially backdoored services or startup items.
-   **Disabled/Misconfigured Security:** Windows Defender potentially disabled, UAC lowered, insecure audit policy settings.
-   **Forensic Artifacts:** Log entries indicating compromise, specific files containing answers or clues (including a competition-style README), potentially modified system files (simulated), browser history artifacts.
-   **Competition README:** A `README-Incident.txt` file placed on the Desktop detailing the scenario, authorized users/services, forensic questions, and rules of engagement.

## Setup Instructions (Instructor/Mentor)

1.  **Prepare Clean VM:** Start with a clean, fully updated Windows 10/11 Pro/Enterprise VM. **Take a snapshot named "Clean Base Install" BEFORE running the script.**
2.  **Transfer Script:** Copy `enterprise-workstation-setup.ps1` to the clean VM.
3.  **Run as Admin:** Open PowerShell **as Administrator**.
4.  **Set Execution Policy (if needed):** `Set-ExecutionPolicy Bypass -Scope Process -Force` (or `RemoteSigned`).
5.  **Execute Script:** Navigate to the script location and run it: `.\enterprise-workstation-setup.ps1`.
6.  **Review Output/Logs:** Check the PowerShell console for errors. The script may create a log file (e.g., `C:\cyberpatriot_setup_log.txt`) - review it.
7.  **Shut Down VM:** Once the script completes successfully, shut down the VM cleanly.
8.  **CRITICAL: Final Snapshot:** Take a VM snapshot named **"CP Scenario - Initial State"** (or similar). **This is the snapshot distributed to cadets for practice.** Do NOT distribute the clean base or snapshots taken during setup.

## Usage Instructions for Cadets

1.  **Start VM:** Launch the VM from the **"CP Scenario - Initial State"** snapshot provided by your instructor.
2.  **Login:** Use the initial credentials provided (these might be in the scenario description given by the instructor or default credentials known from practice).
3.  **READ THE README:** Immediately locate and **carefully read** the `README-Incident.txt` file on the Desktop. This contains critical scenario details, scoring tasks, authorized items, and forensic questions.
4.  **Investigate & Baseline:** Begin investigation using standard tools (`eventvwr.msc`, `secpol.msc`, `services.msc`, `taskschd.msc`, `regedit`, `net user`, `Get-LocalGroupMember`, etc.) and potentially provided audit scripts (`../Scripts/`). Perform an initial reconnaissance/baseline.
5.  **Remediate & Harden:** Address vulnerabilities, remove persistence, configure policies, manage users/services according to the README and security best practices. Follow a structured workflow (Users -> Persistence -> Services -> Policies -> Network -> Forensics).
6.  **Document:** Maintain a detailed Change Log (`../../Resources/Templates/Change_Log_Template.md`). Record findings for forensic questions (`../../Resources/Templates/Forensics_Question_Response_Template.md`).
7.  **Verify:** Check scoring (if applicable/simulated). Ensure required services remain functional.

## Competition README (`README-Incident.txt` - Generated by Script)

The script aims to create a realistic README file including:
-   Scenario background (e.g., suspected compromise).
-   Cadet tasks/objectives.
-   List of **authorized** users, groups, services, applications.
-   List of **prohibited** actions.
-   Specific forensic questions requiring investigation and answers based on VM evidence.

## Customization

-   Instructors can modify `enterprise-workstation-setup.ps1` to change usernames, passwords, add/remove vulnerabilities, alter persistence methods, or customize the generated README content.
-   Adjust complexity by adding more obscure persistence or requiring more detailed forensic analysis.

## Troubleshooting

-   If the script fails, check the PowerShell error messages and any generated log file. Ensure the script is run as Administrator on a compatible Windows version.
-   If the VM behaves unexpectedly after running the script, revert to the "Clean Base Install" snapshot and retry, checking for script errors.

## Effective Training Approach

Use this VM setup to practice key CyberPatriot strategies:
1.  **Security Mindset:** Focus on *why* changes are needed, not just applying fixes.
2.  **Baselining:** Compare the compromised state against expectations or a clean install guide to spot deviations quickly.
3.  **OS Fluency:** Become deeply familiar with Windows tools, commands, and common configuration locations.
4.  **Structured Workflow:** Practice the Recon -> Users -> Persistence -> Services -> Policies -> Network -> Forensics -> Verify workflow repeatedly.
5.  **README Analysis:** Train cadets to extract critical constraints and objectives from the README first.

---
*This scenario script (`enterprise-workstation-setup.ps1`) and documentation are unique resources for Grissom JROTC CyberPatriot training.*

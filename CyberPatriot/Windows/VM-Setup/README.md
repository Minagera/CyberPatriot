# Windows VM Setup for CyberPatriot: "Enterprise Workstation Compromise" Scenario

This directory provides resources for creating a realistic, compromised Windows VM environment suitable for CyberPatriot incident response training.

## Understanding the Competition

CyberPatriot is best defined as an **incident response and remediation competition** where teams inherit a business computer network that has been compromised. Teams must:

1.  Identify unauthorized changes and security issues
2.  Find and analyze forensic artifacts
3.  Remove attacker persistence mechanisms
4.  Apply security hardening to prevent future attacks

Rather than simply collecting and applying security fixes, successful teams develop a comprehensive approach to understanding and responding to security incidents.

## Overview

The `enterprise-workstation-setup.ps1` script transforms a clean Windows installation (ideally Windows 10/11 Pro/Enterprise) into a compromised workstation simulating a post-breach scenario. Cadets must investigate the breach, identify how attackers gained and maintained access, remove malicious components, implement proper security controls, and answer forensic questions.

## Scenario Features (Generated by Script)

-   **Unauthorized User Accounts:** Includes standard users and potentially hidden admin accounts.
-   **Weak Configurations:** Disabled firewall, weak password policies, insecure service settings.
-   **Persistence Mechanisms:** Malicious scheduled tasks, registry run key entries, potentially backdoored services.
-   **Disabled Security Features:** Windows Defender potentially disabled or misconfigured.
-   **Forensic Artifacts:** Log entries, files (including a competition-style README), potentially modified system files (simulated).
-   **(Optional) Basic Scoring:** A simple mechanism or checklist file might be included for self-assessment.

## Setup Instructions

1.  **Prepare Base VM:** Create a clean Windows 10/11 Pro/Enterprise VM. Ensure it's activated and has network connectivity (required for some script actions like Defender updates). Install common tools if desired (e.g., Sysinternals Suite, a text editor like Notepad++).
2.  **Snapshot:** Take a VM snapshot named "Clean Base" or similar *before* running the script.
3.  **Transfer Script:** Copy the `enterprise-workstation-setup.ps1` script to the VM.
4.  **Run Script:** Open PowerShell **as Administrator**. Navigate to the script location and run it:
    ```powershell
    Set-ExecutionPolicy Bypass -Scope Process -Force
    .\enterprise-workstation-setup.ps1
    ```
5.  **Review Output:** Check the script output and the log file (`C:\setup_log_cyberpatriot.txt`) for any errors.
6.  **Final Snapshot:** Shut down the VM and take a snapshot named "Compromised Scenario - Initial State" or similar. This is the snapshot you distribute to cadets.

## Usage Instructions for Cadets

1.  Start the VM from the "Compromised Scenario - Initial State" snapshot.
2.  Log in using the credentials provided in the scenario (e.g., `ITAdmin / Company2023!`, as mentioned in the script or a separate instruction sheet).
3.  Locate and **carefully read** the competition-style README file placed on the Desktop (e.g., `README-Incident.txt`). This file contains the scenario, authorized users/services, forensic questions, and rules of engagement.
4.  Investigate the system using standard tools (`eventvwr.msc`, `secpol.msc`, `services.msc`, `taskschd.msc`, `regedit.exe`, `net user`, etc.) and the provided audit scripts (`Windows/Scripts/`).
5.  Remediate vulnerabilities, remove persistence, and harden the system according to the README and best practices.
6.  Document findings and actions taken. Answer the forensic questions.
7.  (If applicable) Use any provided scoring mechanism to check progress.

## Competition README (`README-Incident.txt` - Generated by Script)

The script creates a competition-style README file on the desktop that includes:
-   A scenario description (e.g., suspected compromise of an HR workstation).
-   Tasks for the incident response team (cadets).
-   List of authorized users and required services/applications.
-   Specific forensic questions requiring investigation.
-   (Optional) Fictional company security policy snippets.

This mimics the actual README files provided during CyberPatriot competition rounds.

## Customization

-   Edit the `enterprise-workstation-setup.ps1` script to change usernames, passwords, persistence methods, or vulnerabilities.
-   Modify the generated README content within the script.
-   Add/remove vulnerabilities to adjust difficulty.

## Troubleshooting

-   Ensure PowerShell is run as Administrator.
-   VM must have internet access for certain commands (Defender/Firewall checks/updates).
-   Review `C:\setup_log_cyberpatriot.txt` for detailed errors during setup.
-   Ensure the base Windows VM is compatible (Win 10/11 Pro/Enterprise recommended).

## Effective Training Approach

Based on the experiences of national champions, here are key strategies for effective CyberPatriot training using this VM:

### 1. Develop the Security Mindset
Focus on understanding *why* vulnerabilities exist and *how* attackers exploit them, not just applying fixes.

### 2. Baselining Strategy
Train cadets to compare the compromised VM against a clean baseline (or documentation) to identify:
-   Unauthorized user accounts/groups
-   Unusual running services/processes
-   Modified registry entries (especially Run keys)
-   Suspicious scheduled tasks
-   Unexpected network connections/firewall rules
-   Disabled security features

### 3. Operating System Familiarity
Develop deep knowledge of Windows internals:
-   User management and authentication (Local Users and Groups, `net` commands)
-   Registry structure (`regedit.exe`)
-   Group Policy / Local Security Policy (`gpedit.msc` / `secpol.msc`)
-   Service management (`services.msc`)
-   Task Scheduler (`taskschd.msc`)
-   Windows Event Logs (`eventvwr.msc`)
-   Windows Defender / Firewall (`wf.msc`, Settings)
-   NTFS Permissions

### 4. Structured Approach
During practice, follow a methodical process:
1.  Review README and forensic questions thoroughly.
2.  Perform initial reconnaissance (users, groups, services, processes, network).
3.  Address critical user account issues (unauthorized admins, weak passwords).
4.  Hunt for persistence (startup items, scheduled tasks, service changes).
5.  Remediate vulnerabilities (policies, services, software).
6.  Enable/configure security features (Defender, Firewall, Auditing).
7.  Answer forensic questions based on evidence.
8.  Document everything.

---
*This scenario and script are unique and designed for CyberPatriot training only.*

# Week 8: Scripting for Automation (PowerShell & Bash)

## Learning Objectives
By the end of this session, cadets will be able to:
- Write basic scripts in PowerShell and Bash for security automation
- Use scripting to audit and report on system security status
- Implement automated security configurations with scripts
- Automate repetitive security tasks
- Parse and analyze security-related log files
- Create security compliance checking scripts
- Interpret and modify existing security scripts
- Apply scripting to CyberPatriot competition scenarios

## Pre-class Preparation
- Review [PowerShell Scripting Basics](../../Windows/Guides/Intermediate/PowerShell_Scripting_Basics.md)
- Review [Bash Scripting Basics](../../Linux/Guides/Intermediate/Bash_Scripting_Basics.md)
- Watch [Security Automation Scripting video](https://www.youtube.com/watch?v=example) (placeholder link)
- Install [Visual Studio Code](https://code.visualstudio.com/) or preferred text editor

## Lesson Plan

### 1. Security Automation Fundamentals (20 minutes)
- Benefits of security automation
- Identifying automation opportunities
- Automation challenges and limitations
- Scripting languages for security automation
- Balancing automation and manual processes
- Automation security considerations
- Scripting best practices
- Applying automation in CyberPatriot competitions

### 2. PowerShell Security Scripting (40 minutes)
- PowerShell security features and execution policies
- PowerShell syntax review
- Core cmdlets for security administration
- Working with:
  - User accounts and groups
  - Security settings
  - Registry
  - Services
  - Firewall rules
  - Event logs
- Creating security audit scripts
- Implementing security configurations
- Parsing and analyzing security data
- Script error handling and logging

### 3. Bash Security Scripting (40 minutes)
- Bash scripting fundamentals review
- Bash security considerations
- Security-relevant commands and tools
- Working with:
  - User accounts and groups
  - Permissions
  - Services
  - Network settings
  - Firewall rules
  - System logs
- Creating security audit scripts
- Implementing security configurations
- Script error handling and logging
- Regular expressions for security parsing

### 4. Log Analysis Scripts (30 minutes)
- Security log sources and formats
- Log parsing techniques
- Filtering relevant security events
- Pattern matching for security incidents
- Aggregating security data
- Generating security reports
- Alerting on security issues
- Visualizing security data
- Scripting for continuous monitoring

### 5. Compliance Checking Scripts (30 minutes)
- Security baseline verification
- CIS benchmark automation
- Compliance status reporting
- Implementing security checklists
- Identifying security deviations
- Reporting compliance status
- Automating remediation
- Documentation generation

### 6. Hands-on Exercise (60 minutes)
- **Exercise**: [Security Automation Scripting Lab](../../Exercises/Security_Automation_Scripting_Lab.md)
  - Create a PowerShell security audit script
  - Develop a Bash security hardening script
  - Implement automated security checks
  - Generate security status reports
  - Practice with existing script templates

### 7. Assessment (20 minutes)
- [Security Scripting Quiz](../../Quizzes/Quiz-Files/Security_Scripting_Quiz.md)
- Script review and optimization
- Troubleshooting script issues

### 8. Wrap-up and Preview (10 minutes)
- Recap scripting concepts
- Assign homework (see below)
- Preview next week (Advanced Windows Security)
- Q&A session

## Homework Assignment
1. Complete the [Security Audit Script Development](../../Scripts/Templates/Security_Audit_Template.md) challenge
2. Develop a script that implements at least three security hardening tasks
3. Modify an existing script to add additional security checks
4. Create a documentation generator script for security changes

## Additional Resources
- [PowerShell Security Documentation](https://docs.microsoft.com/en-us/powershell/scripting/security/security-features)
- [Bash Scripting Guide](https://tldp.org/LDP/abs/html/)
- [Security Automation Best Practices](https://example.com/security-automation) (placeholder link)
- [PowerShell Security Script Repository](https://github.com/PowerShellMafia/PowerSploit)
- [Linux Security Scripts Collection](https://github.com/example/linux-security-scripts) (placeholder link)

## Materials Needed
- Windows and Linux VMs for each cadet
- Visual Studio Code or preferred text editor
- Script templates and examples
- Script debugging tools
- Security logging examples
- Projection system for demonstrations
- Access to repository materials

## Instructor Notes
- This session requires hands-on practice - allocate sufficient time
- Prepare simplified examples for beginners
- Have more advanced challenges ready for experienced scripters
- Consider pairing cadets with different experience levels
- Be ready to troubleshoot script syntax issues
- Emphasize the importance of testing scripts in a safe environment
- Show real examples of automation in CyberPatriot competitions
- Focus on scripts that would be most useful in competition
- Balance teaching programming concepts with practical application
- Provide script templates to avoid starting from scratch
- Consider creating a script repository for the team to contribute to
